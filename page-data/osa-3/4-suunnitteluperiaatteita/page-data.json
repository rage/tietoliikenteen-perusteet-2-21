{"componentChunkName":"component---src-templates-course-content-template-js","path":"/osa-3/4-suunnitteluperiaatteita","result":{"data":{"page":{"htmlAst":{"type":"element","tagName":"div","properties":{},"children":[{"type":"element","tagName":"text-box","properties":{"variant":"learningObjectives","name":"Oppimistavoitteet"},"children":[{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"tunnistat mitä suunnitteluperiaatteita protokolla noudattaa."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"Osaat arvioida miten protokollan toiminnassa on otettu huomioon tiettyjä suunnitteluperiaatteita."}]},{"type":"text","value":"\n"}]}]},{"type":"element","tagName":"h2","properties":{"id":"protokollan-suunnittelussa-huomioitavaa","style":"position:relative;"},"children":[{"type":"text","value":"Protokollan suunnittelussa huomioitavaa"},{"type":"element","tagName":"a","properties":{"href":"#protokollan-suunnittelussa-huomioitavaa","ariaLabel":"protokollan suunnittelussa huomioitavaa permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Aina kun suunnittelemme protokollaa tai selvitämme jonkun protokollan toimintaa, on hyvä muistaa, että kaikkien protokollien toiminnassa on paljon yhteisiä piirteitä ja toki myös paljon eroja. Keskitytään tässä protokollien yleisiin piirteisiin."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Nyt kun olemme tutustuneet protokollien mallinnukseen ja kuljetuskerroksen protokollien tavoitteisiin, on aika käydä systemaattisemmin läpi protokollien yleiset piirteet eli niiden suhtautuminen viestien oikeellisuuteen, katoamiseen ja siihen liittyviin kuittauksiin ja ajastimiin sekä viestien järjestyksen hallintaan eli järjestysnumeroihin."}]},{"type":"element","tagName":"h2","properties":{"id":"oikeellisuustarkistus","style":"position:relative;"},"children":[{"type":"text","value":"Oikeellisuustarkistus"},{"type":"element","tagName":"a","properties":{"href":"#oikeellisuustarkistus","ariaLabel":"oikeellisuustarkistus permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Koska viestin kuljetuksessa lähettäjältä vastaanottajalle on aina riski esimerkiksi bittivirheille, on protokollan tehtävä huolehtia mahdollisesta viestin oikeellisuuden tarkistuksesta. Kuljetuskerroksen protokolla voi toki jättää viestin sisällön oikeellisuuden tarkistamisen ylemmän eli sovelluskerroksen protokollan tehtäväksi. Alemman kerroksen protokollan tehtävänä se vastaisi oletusta, että kanava ei vaurioita viestejä. Yleensä jokainen kerros vastaa vähintään oman otsakkeensa oikeellisuuden tarkistuksesta."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Viestin muuttumattomuus voidaan tarkistaa joko pelkästään virheen havaitsevalla menetelmällä tai menetelmällä, joka voi tarvittaessa myös korjata virheen. Lähettäjä laskee tarvittavan lisätiedon osaksi viestiä ja vastaanottaja tarkistaa, että viesti ei ole muuttunut laskemalla tämän tiedon uudelleen ja vertaamalla sitä viestin mukana tulleeseen tietoon."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Viestin tarkistaminen edellyttää aina tämän lisätiedon eli "},{"type":"element","tagName":"a","properties":{"href":"https://fi.wikipedia.org/wiki/Tarkistussumma","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"tarkistussumman"}]},{"type":"text","value":" lisäämistä viestiin. Tarkistussummalle varataan kiinteänkokoinen osa protokollan viestistä. Tarkistussumman laskentaan ja tarkistamiseen on tarjolla useita erilaisia menetelmiä."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Jos tyydytään virheen havaitsemiseen, niin silloin ainoa vaihtoehto on hävittää vioittunut paketti. Mikä tahansa laite joka vastaanottaa paketin, jonka tarkistussumma ei vastaanottajalla enää vasta viestin sisältöä, hävittää tällaisen paketin. Virheen havaitsemiseen voidaan käyttää ainakin jotain seuraavista:"}]},{"type":"element","tagName":"ul","properties":{},"children":[{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://fi.wikipedia.org/wiki/Pariteetti_(tietotekniikka)","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"pariteetti"}]},{"type":"text","value":" on näistä menetelmistä yksinkertaisin ja se voidaan laskea joko bitti tai tavutasolla."}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"text","value":"yhteenlaskuun perustuva tarkistussumma, kuten UDP:n tarkistussumma. (Tästä on esimerkki aliluvussa UDP)"}]},{"type":"text","value":"\n"},{"type":"element","tagName":"li","properties":{},"children":[{"type":"element","tagName":"a","properties":{"href":"https://fi.wikipedia.org/wiki/Tiiviste_(tietotekniikka)","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"tiiviste"}]},{"type":"text","value":" voidaan laskea monella erilaisella tiivistefunktiolla tai tiivistealgoritmilla. (Tästä tulee esimerkki myöhemmässä osiossa linkkikerros - virheiden havaitseminen)"}]},{"type":"text","value":"\n"}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Jos halutaan havaitsemisen lisäksi myös tarvittaessa korjata vikaantunut viesti, niin viestin mukana täytyy kuljettaa enemmän tarkistusinformaatiota, jotta korjaaminen onnistuu. "},{"type":"element","tagName":"a","properties":{"href":"https://fi.wikipedia.org/wiki/Virheenkorjauskoodi","target":"_blank","rel":["noopener","noreferrer"]},"children":[{"type":"text","value":"Virheenkorjaukseenkin"}]},{"type":"text","value":" on tarjolla paljon erilaisia menetelmiä, kuten Hamming-koodi. Näitä ei useinkaan käytetä tietoliikenteen ylemmillä kerroksilla, koska viestit ovat varsin suuria ja virheenkorjauksen vaatima lisätila olisi tarpeettoman suuri hyötyyn nähden."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Yksittäisten protokollien käyttämiin menetelmiin tutustutaan näiden protokollien yhteydessä."}]},{"type":"element","tagName":"h2","properties":{"id":"ajastin","style":"position:relative;"},"children":[{"type":"text","value":"Ajastin"},{"type":"element","tagName":"a","properties":{"href":"#ajastin","ariaLabel":"ajastin permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Lähettäjä yleensä aina tarvitsee ajastimen, jolla voidaan katkaista liian pitkään kestänyt vastauksen odotus. Jos lähettäjän odotusta ei katkaista ajastimen laukeamisella, protokollan toiminta ei voi edetä. Vastaanottajan odotukseen ajastin ei ole tarpeen, koska vastaanottaja ei kuitenkaan voi edetä ilman saapuvaa viestiä."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Ajastimen kanssa keskeistä on arvioida, mikä on sopiva maksimiodotusaika, jonka jälkeen ajastimen olisi hyvä laueta mikäli vastausta ei ole saapunut.  Liian aikaisin laukeava ajastin aiheuttaa tarpeettoman uudelleenlähetyksen ja tarpeettoman myöhään laukeava viivästää järjestelmän toimintaa. Hyvä lähtökohta on käyttää ajastimen arvona kaksikertaista kiertoviivettä."}]},{"type":"element","tagName":"h2","properties":{"id":"kuittaukset","style":"position:relative;"},"children":[{"type":"text","value":"Kuittaukset"},{"type":"element","tagName":"a","properties":{"href":"#kuittaukset","ariaLabel":"kuittaukset permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Aiemmissa osioissa on käsitelty niin sanottuja positiivisia kuittauksia (engl. positive ACK). Niillä vastaanottaja kuittaa saapuneita viestejä."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Protokolla voi käyttää positiivisten kuittausten sijasta tai lisäksi myös negatiivisia kuittauksia (engl. negative acknowledge, NAK). Negatiivisella kuittauksella vastaanottaja kertoo, että se ei ole saanut jotain viestiä vaikka se sitä odottaa. Mikäli vastaanottaja käyttää negatiivisia kuittauksia, se saattaa tarvita ajastinta, mutta yleensä vastaanottaja käyttää saapuvia viestejä apuna."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Esimerkiksi valikoivien kuittausten kanssa vastaanottaja voisi lähettää negatiivisen kuittauksen välittömästi, kun joku paketti jää pois välistä eli kyseistä pakettia seuraavan paketin saapuessa. Näin vastaanottaja voisi päästä lähettämään viestin uudelleen paljon aiemmin kuin vasta ajastimen laukeamisen jälkeen."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Järjestelmässä täytyy aina myös varautua ns. tuplakuittauksiin, eli saman kuittauksen lähettämiseen ja vastaanottamiseen useampia kertoja. Tältä ei voi välttyä, koska kun vastaanottaja saa jo saapuneen paketin uudelleen, sen täytyy lähettää kyseiseen pakettiin liittyvä kuittaus uudelleen. Mikäli tätä lähettämistä ei tehtäisi, niin lähettäjä ei ehkä saisi koskaan kuittausta kyseisestä viestistä."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Toisaalta näitä tuplakuittauksia alkuperäinen lähettäjä voi myös pyrkiä hyödyntämään. Esimerkiksi Paluu-N:ään menetelmässä vastaanottaja kuittaa aina samalla kuittausnumerolla kaikki epäjärjestyksessä saapuvat viestit. Lähettäjä voi hyödyntää tätä tietoa ja tehdä uudelleenlähetyksen jo näiden tuplakuittausten perusteella ennen kuin ajastin laukeaa."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Eri protokollat tai niiden eri versiot käyttävät näitä kaikkia vaihtoehtoja."}]},{"type":"element","tagName":"h2","properties":{"id":"jarjestysnumero","style":"position:relative;"},"children":[{"type":"text","value":"Järjestysnumero"},{"type":"element","tagName":"a","properties":{"href":"#jarjestysnumero","ariaLabel":"jarjestysnumero permalink","className":["anchor","after"]},"children":[{"type":"element","tagName":"svg","properties":{"ariaHidden":"true","focusable":"false","height":"16","version":"1.1","viewBox":"0 0 16 16","width":"16"},"children":[{"type":"element","tagName":"path","properties":{"fillRule":"evenodd","d":"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"},"children":[]}]}]}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Protokollat käyttävät viesteissä usein järjestysnumeroa tai tunnistenumeroa, jolla viestit voidaan erottaa toisistaan. Taas protokollan omien tarpeiden mukaan tämän numerointi voi olla vain tunnistamiseen tai myös järjestämiseen."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Kun numeroa käytetään järjestämiseen, on tärkeää, että numerointi on yhtäjaksoinen, jotta mahdolliset puuttuvat viestit voidaan havaita. Yhtäjaksoisuus ei kuitenkaan aina tarkoita, että viestinumerot olisivat peräkkäisiä kokonaislukuja. Esimerkiksi TCP numeroi viestinsä siten, että kahden peräkkäisen viestin numeroiden erotus on edellisen viestin datan koko tavuina."}]},{"type":"element","tagName":"p","properties":{},"children":[{"type":"text","value":"Lähdetään seuraavaksi tutkimaan TCP:n toimintaa tarkemmin."}]}]},"html":"<div><text-box variant='learningObjectives' name='Oppimistavoitteet'><ul>\n<li>tunnistat mitä suunnitteluperiaatteita protokolla noudattaa.</li>\n<li>Osaat arvioida miten protokollan toiminnassa on otettu huomioon tiettyjä suunnitteluperiaatteita.</li>\n</ul></text-box><h2 id=\"protokollan-suunnittelussa-huomioitavaa\" style=\"position:relative;\">Protokollan suunnittelussa huomioitavaa<a href=\"#protokollan-suunnittelussa-huomioitavaa\" aria-label=\"protokollan suunnittelussa huomioitavaa permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p>Aina kun suunnittelemme protokollaa tai selvitämme jonkun protokollan toimintaa, on hyvä muistaa, että kaikkien protokollien toiminnassa on paljon yhteisiä piirteitä ja toki myös paljon eroja. Keskitytään tässä protokollien yleisiin piirteisiin.</p><p>Nyt kun olemme tutustuneet protokollien mallinnukseen ja kuljetuskerroksen protokollien tavoitteisiin, on aika käydä systemaattisemmin läpi protokollien yleiset piirteet eli niiden suhtautuminen viestien oikeellisuuteen, katoamiseen ja siihen liittyviin kuittauksiin ja ajastimiin sekä viestien järjestyksen hallintaan eli järjestysnumeroihin.</p><h2 id=\"oikeellisuustarkistus\" style=\"position:relative;\">Oikeellisuustarkistus<a href=\"#oikeellisuustarkistus\" aria-label=\"oikeellisuustarkistus permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p>Koska viestin kuljetuksessa lähettäjältä vastaanottajalle on aina riski esimerkiksi bittivirheille, on protokollan tehtävä huolehtia mahdollisesta viestin oikeellisuuden tarkistuksesta. Kuljetuskerroksen protokolla voi toki jättää viestin sisällön oikeellisuuden tarkistamisen ylemmän eli sovelluskerroksen protokollan tehtäväksi. Alemman kerroksen protokollan tehtävänä se vastaisi oletusta, että kanava ei vaurioita viestejä. Yleensä jokainen kerros vastaa vähintään oman otsakkeensa oikeellisuuden tarkistuksesta.</p><p>Viestin muuttumattomuus voidaan tarkistaa joko pelkästään virheen havaitsevalla menetelmällä tai menetelmällä, joka voi tarvittaessa myös korjata virheen. Lähettäjä laskee tarvittavan lisätiedon osaksi viestiä ja vastaanottaja tarkistaa, että viesti ei ole muuttunut laskemalla tämän tiedon uudelleen ja vertaamalla sitä viestin mukana tulleeseen tietoon.</p><p>Viestin tarkistaminen edellyttää aina tämän lisätiedon eli <a href=\"https://fi.wikipedia.org/wiki/Tarkistussumma\" target=\"_blank\" rel=\"noopener noreferrer\">tarkistussumman</a> lisäämistä viestiin. Tarkistussummalle varataan kiinteänkokoinen osa protokollan viestistä. Tarkistussumman laskentaan ja tarkistamiseen on tarjolla useita erilaisia menetelmiä.</p><p>Jos tyydytään virheen havaitsemiseen, niin silloin ainoa vaihtoehto on hävittää vioittunut paketti. Mikä tahansa laite joka vastaanottaa paketin, jonka tarkistussumma ei vastaanottajalla enää vasta viestin sisältöä, hävittää tällaisen paketin. Virheen havaitsemiseen voidaan käyttää ainakin jotain seuraavista:</p><ul>\n<li><a href=\"https://fi.wikipedia.org/wiki/Pariteetti_(tietotekniikka)\" target=\"_blank\" rel=\"noopener noreferrer\">pariteetti</a> on näistä menetelmistä yksinkertaisin ja se voidaan laskea joko bitti tai tavutasolla.</li>\n<li>yhteenlaskuun perustuva tarkistussumma, kuten UDP:n tarkistussumma. (Tästä on esimerkki aliluvussa UDP)</li>\n<li><a href=\"https://fi.wikipedia.org/wiki/Tiiviste_(tietotekniikka)\" target=\"_blank\" rel=\"noopener noreferrer\">tiiviste</a> voidaan laskea monella erilaisella tiivistefunktiolla tai tiivistealgoritmilla. (Tästä tulee esimerkki myöhemmässä osiossa linkkikerros - virheiden havaitseminen)</li>\n</ul><p>Jos halutaan havaitsemisen lisäksi myös tarvittaessa korjata vikaantunut viesti, niin viestin mukana täytyy kuljettaa enemmän tarkistusinformaatiota, jotta korjaaminen onnistuu. <a href=\"https://fi.wikipedia.org/wiki/Virheenkorjauskoodi\" target=\"_blank\" rel=\"noopener noreferrer\">Virheenkorjaukseenkin</a> on tarjolla paljon erilaisia menetelmiä, kuten Hamming-koodi. Näitä ei useinkaan käytetä tietoliikenteen ylemmillä kerroksilla, koska viestit ovat varsin suuria ja virheenkorjauksen vaatima lisätila olisi tarpeettoman suuri hyötyyn nähden.</p><p>Yksittäisten protokollien käyttämiin menetelmiin tutustutaan näiden protokollien yhteydessä.</p><h2 id=\"ajastin\" style=\"position:relative;\">Ajastin<a href=\"#ajastin\" aria-label=\"ajastin permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p>Lähettäjä yleensä aina tarvitsee ajastimen, jolla voidaan katkaista liian pitkään kestänyt vastauksen odotus. Jos lähettäjän odotusta ei katkaista ajastimen laukeamisella, protokollan toiminta ei voi edetä. Vastaanottajan odotukseen ajastin ei ole tarpeen, koska vastaanottaja ei kuitenkaan voi edetä ilman saapuvaa viestiä.</p><p>Ajastimen kanssa keskeistä on arvioida, mikä on sopiva maksimiodotusaika, jonka jälkeen ajastimen olisi hyvä laueta mikäli vastausta ei ole saapunut.  Liian aikaisin laukeava ajastin aiheuttaa tarpeettoman uudelleenlähetyksen ja tarpeettoman myöhään laukeava viivästää järjestelmän toimintaa. Hyvä lähtökohta on käyttää ajastimen arvona kaksikertaista kiertoviivettä.</p><h2 id=\"kuittaukset\" style=\"position:relative;\">Kuittaukset<a href=\"#kuittaukset\" aria-label=\"kuittaukset permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p>Aiemmissa osioissa on käsitelty niin sanottuja positiivisia kuittauksia (engl. positive ACK). Niillä vastaanottaja kuittaa saapuneita viestejä.</p><p>Protokolla voi käyttää positiivisten kuittausten sijasta tai lisäksi myös negatiivisia kuittauksia (engl. negative acknowledge, NAK). Negatiivisella kuittauksella vastaanottaja kertoo, että se ei ole saanut jotain viestiä vaikka se sitä odottaa. Mikäli vastaanottaja käyttää negatiivisia kuittauksia, se saattaa tarvita ajastinta, mutta yleensä vastaanottaja käyttää saapuvia viestejä apuna.</p><p>Esimerkiksi valikoivien kuittausten kanssa vastaanottaja voisi lähettää negatiivisen kuittauksen välittömästi, kun joku paketti jää pois välistä eli kyseistä pakettia seuraavan paketin saapuessa. Näin vastaanottaja voisi päästä lähettämään viestin uudelleen paljon aiemmin kuin vasta ajastimen laukeamisen jälkeen.</p><p>Järjestelmässä täytyy aina myös varautua ns. tuplakuittauksiin, eli saman kuittauksen lähettämiseen ja vastaanottamiseen useampia kertoja. Tältä ei voi välttyä, koska kun vastaanottaja saa jo saapuneen paketin uudelleen, sen täytyy lähettää kyseiseen pakettiin liittyvä kuittaus uudelleen. Mikäli tätä lähettämistä ei tehtäisi, niin lähettäjä ei ehkä saisi koskaan kuittausta kyseisestä viestistä.</p><p>Toisaalta näitä tuplakuittauksia alkuperäinen lähettäjä voi myös pyrkiä hyödyntämään. Esimerkiksi Paluu-N:ään menetelmässä vastaanottaja kuittaa aina samalla kuittausnumerolla kaikki epäjärjestyksessä saapuvat viestit. Lähettäjä voi hyödyntää tätä tietoa ja tehdä uudelleenlähetyksen jo näiden tuplakuittausten perusteella ennen kuin ajastin laukeaa.</p><p>Eri protokollat tai niiden eri versiot käyttävät näitä kaikkia vaihtoehtoja.</p><h2 id=\"jarjestysnumero\" style=\"position:relative;\">Järjestysnumero<a href=\"#jarjestysnumero\" aria-label=\"jarjestysnumero permalink\" class=\"anchor after\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2><p>Protokollat käyttävät viesteissä usein järjestysnumeroa tai tunnistenumeroa, jolla viestit voidaan erottaa toisistaan. Taas protokollan omien tarpeiden mukaan tämän numerointi voi olla vain tunnistamiseen tai myös järjestämiseen.</p><p>Kun numeroa käytetään järjestämiseen, on tärkeää, että numerointi on yhtäjaksoinen, jotta mahdolliset puuttuvat viestit voidaan havaita. Yhtäjaksoisuus ei kuitenkaan aina tarkoita, että viestinumerot olisivat peräkkäisiä kokonaislukuja. Esimerkiksi TCP numeroi viestinsä siten, että kahden peräkkäisen viestin numeroiden erotus on edellisen viestin datan koko tavuina.</p><p>Lähdetään seuraavaksi tutkimaan TCP:n toimintaa tarkemmin.</p></div>","frontmatter":{"path":"/osa-3/4-suunnitteluperiaatteita","title":"Suunnitteluperiaatteita"},"fileAbsolutePath":"/home/runner/work/tietoliikenteen-perusteet-2-21/tietoliikenteen-perusteet-2-21/data/osa-3/4-suunnitteluperiaatteita.md"},"allPages":{"edges":[{"node":{"id":"07fbca84-2996-5ef5-91f4-80c8d67b1f6d","frontmatter":{"path":"/frontmatter-guide","title":"Frontmatter-guide"}}},{"node":{"id":"f94770ac-b87c-5b6d-aea7-87e3206ebc1a","frontmatter":{"path":"/","title":"Tietoa kurssista"}}},{"node":{"id":"72f0d3aa-a615-5485-927a-1d9efa922a6d","frontmatter":{"path":"/kurssin-suorittaminen","title":"Kurssin suorittaminen"}}},{"node":{"id":"5dc284ce-33b0-5641-92d3-f3cbd298ae3e","frontmatter":{"path":"/opettajille","title":"Opettajille ja opinto-ohjaajille"}}},{"node":{"id":"71ffb689-39cd-54e4-afb1-10639d37b540","frontmatter":{"path":"/osaamistavoitteet","title":"Osaamistavoitteet"}}},{"node":{"id":"92902113-bd4d-54cb-8e4c-2d914a94a43b","frontmatter":{"path":"/tukivaylat","title":"Tukiväylät"}}},{"node":{"id":"73d38dec-d739-5d94-b391-abef8e5373b6","frontmatter":{"path":"/usein-kysytyt-kysymykset","title":"Usein kysytyt kysymykset"}}},{"node":{"id":"18912f50-4c07-571f-9704-91752a0bc432","frontmatter":{"path":"/osa-1/1-johdanto","title":"Johdanto"}}},{"node":{"id":"451f39f3-eecd-5fe0-a231-f701dbb224ea","frontmatter":{"path":"/osa-1/2-kertausta","title":"Kertausta"}}},{"node":{"id":"0148ecbb-fcfc-575a-ad8c-63788d56b585","frontmatter":{"path":"/osa-1/3-viipeet-ja-läpäisy","title":"Viipeet ja läpäisy"}}},{"node":{"id":"dbfac743-cc99-5393-83ad-23546879a4ff","frontmatter":{"path":"/osa-1/4-piirikytkentä","title":"Pakettikytkentä vs piirikytkentä"}}},{"node":{"id":"caab8edd-cf17-5b21-bfcd-4f30373615af","frontmatter":{"path":"/osa-1/5-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"2edd2121-da28-5faa-a44c-8f2d579fdc83","frontmatter":{"path":"/osa-1","title":"Osa 1: Yleistä"}}},{"node":{"id":"6a6f50c9-6751-5805-b191-0dc5ea90c487","frontmatter":{"path":"/osa-2/1-periaatteita","title":"Verkkosovelluksen toimintaperiaatteita"}}},{"node":{"id":"ccab9cf4-3881-552b-a03c-8cc97041dc82","frontmatter":{"path":"/osa-2/2-laki-ja-kuuntelu","title":"Verkon kuuntelu ja lainsäädäntö"}}},{"node":{"id":"4d9b998c-1b33-541d-a142-0f0cad57da54","frontmatter":{"path":"/osa-2/3-nimipalvelu","title":"Nimipalvelu"}}},{"node":{"id":"54075fab-cf7e-59f3-aad5-1a2fbfbc549a","frontmatter":{"path":"/osa-2/5-verkko-ohjelmointi-rajapinta","title":"Verkko-ohjelmointi ja sovelluksen rajapinta"}}},{"node":{"id":"6309357c-886a-5e4d-88c1-399099c965ab","frontmatter":{"path":"/osa-2/4-sahkoposti","title":"Sähköposti"}}},{"node":{"id":"c18adde4-4460-569a-819b-fc93ea16b497","frontmatter":{"path":"/osa-2/6-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"38f09292-8ebb-55a2-aeb0-9efba1ccc739","frontmatter":{"path":"/osa-2","title":"Osa 2: Sovelluskerros"}}},{"node":{"id":"13a24d8f-bc56-5d8a-8aa4-1e6f602af95e","frontmatter":{"path":"/osa-3/1-kuljetuspalvelu","title":"Kuljetuspalvelun toiminta"}}},{"node":{"id":"ef3093c1-baa2-56e7-a495-6cf6fcafdda7","frontmatter":{"path":"/osa-3/2-periaatteet","title":"Luotettavan kuljetuspalvelun periaatteet"}}},{"node":{"id":"b955b25c-822f-56a2-a571-d0ed4227e4ef","frontmatter":{"path":"/osa-3/4-suunnitteluperiaatteita","title":"Suunnitteluperiaatteita"}}},{"node":{"id":"4da3b549-a94d-5a7a-91dd-71b2d6a1e4d1","frontmatter":{"path":"/osa-3/3-liukuvaikkuna","title":"Liukuva ikkuna"}}},{"node":{"id":"a9f3b554-3a38-5f0f-99a9-8375816fd4cb","frontmatter":{"path":"/osa-3/6-udp","title":"UDP"}}},{"node":{"id":"0be5b703-d205-501e-b174-e8d33e95c832","frontmatter":{"path":"/osa-3/7-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"7b424c06-2601-5402-bc43-c2959d121643","frontmatter":{"path":"/osa-3","title":"Osa 3: Kuljetuskerros"}}},{"node":{"id":"b20703a9-2d0a-5467-a824-c86ac6579e1d","frontmatter":{"path":"/osa-4/1-IPv4-IPv6","title":"IPv4 ja IPv6 osoitteet"}}},{"node":{"id":"724b3cc2-dd79-5872-a0e6-706fece0415a","frontmatter":{"path":"/osa-3/5-tcp","title":"TCP"}}},{"node":{"id":"80365dff-896c-5368-896e-eec79b5129b0","frontmatter":{"path":"/osa-4/2-IP-protokolla","title":"IP-protokolla"}}},{"node":{"id":"55d42f0f-65fe-5038-8b60-67f6fc4bff83","frontmatter":{"path":"/osa-4/3-reititys","title":"Reititys"}}},{"node":{"id":"77442160-5292-5d91-b03f-c12f326017ca","frontmatter":{"path":"/osa-4/5-muita-verkkokerroksen-protokollia.md","title":"Muita verkkokerroksen protokollia"}}},{"node":{"id":"0c4f9075-9058-5109-8b3e-33cf37e05e05","frontmatter":{"path":"/osa-4/4-reititin","title":"Reititin"}}},{"node":{"id":"bb679c1b-fa88-5f1a-bcb5-5c7e4e0fb566","frontmatter":{"path":"/osa-4/6-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"a251821d-10ca-5d3c-8e2e-486145b750bb","frontmatter":{"path":"/osa-4","title":"Osa 4: Verkkokerros"}}},{"node":{"id":"5e45a11a-8de3-5284-a686-5fbd5828cc39","frontmatter":{"path":"/osa-5/1-linkki-toiminta","title":"Yleistä linkkikerroksen toiminnasta"}}},{"node":{"id":"4006d9b8-5c45-5f82-84c4-ec932ff6cca4","frontmatter":{"path":"/osa-5/2-virheidenhavaitseminen","title":"Virheiden havaitseminen ja korjaaminen"}}},{"node":{"id":"ccba763f-0ffa-5398-a9c2-6f9e23b97270","frontmatter":{"path":"/osa-5/4-kytkin","title":"Kytkin"}}},{"node":{"id":"116b10b0-2f44-5011-a169-593eecfe6d50","frontmatter":{"path":"/osa-5/5-toiseen-verkkoon","title":"Lähettäminen toiseen verkkoon"}}},{"node":{"id":"54ca89a6-0d64-515e-8101-498fdcee037f","frontmatter":{"path":"/osa-5/3-vuorojen-jakelu","title":"Lähetysvuorojen jakelu"}}},{"node":{"id":"ba6c210e-c87f-5f21-95af-f5e66c293f36","frontmatter":{"path":"/osa-5/7-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"830def90-4428-575f-99a5-c9231b692dcd","frontmatter":{"path":"/osa-5","title":"Osa 5: Linkkikerros"}}},{"node":{"id":"a7407bc4-70d0-5174-9953-3860b86f2863","frontmatter":{"path":"/osa-6/1-kaikki-yhteen","title":"Kaikki yhteen"}}},{"node":{"id":"8e65b949-f5a9-5dd4-926d-2a678606218d","frontmatter":{"path":"/osa-6/2-yhteenveto","title":"Yhteenveto"}}},{"node":{"id":"f9c4a320-75ad-58cf-a44a-6f76b761e08f","frontmatter":{"path":"/osa-5/6-langaton","title":"Langaton verkko"}}},{"node":{"id":"5daae54a-eb34-5ed0-b5a7-93b1d4ba1a68","frontmatter":{"path":"/osa-6","title":"Osa 6: Kaikki yhteen"}}}]}},"pageContext":{}},"staticQueryHashes":["3294351120","994120085"]}